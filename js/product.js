function initall(o){function i(o){if(option.unitprice){var i=GetQueryString("unitprice")?parseInt(.8*GetQueryString("unitprice"))+"-"+GetQueryString("unitprice"):"";o.unitprice=i||!1}filldom("productmenu-templete",o,"productmenu");var t=0;$.each($("#productmenu li.brand-item"),function(o){t+=parseInt($(this).width()+25)}),t>$(".select-left").width()?$("span.more").css("display","inline-block"):$("span.more").css("display","none")}o.queryOption=!0,o.queryGoods=!1,getdata(posturl1,o,"",i)}function init(o){function i(i){filldom("productlist-templete",i,"productlist"),$("img").lazyload({placeholder:"../img/loading.png",effect:"fadeIn"}),$.each(goodsArr,function(o,i){var t=i.id;$(".contrast").each(function(o,i){t==$(this).attr("cid")&&$(this).prop("checked",!0)})}),dataArr=[],dataArr=i.page.list,orgpageInit("changeNo",".paginorange",i.page.totalPage,o.page)}o.queryGoods=!0,o.queryOption=!1,getdata(posturl,o,"",i)}function changeNo(o){if(!/^[1-9]*[1-9][0-9]*$/.test(o))return layer.msg("页码只能是数字！"),!1;$(".pageIndex").val(o),option.page=o,$(window).scrollTop("405"),init(option)}var dataArr,breadcrumb="",goodsArr=[],oldHtml=$(".goods-list").html(),option={status:"",goodsName:"",catalogCode:"",goodsSource:"",goodsPrice:"",upPrice:"",downPrice:"",unitprice:"",goodsBrand:"",goodsBrandId:"",queryOption:!0,queryGoods:!0,param:"",orderBy:"",page:1,limit:"20"},posturl="../js/json/product.json",posturl1="../js/json/brand.json";$(function(){breadcrumb+='<span><a href="index.html">首页</a></span>',option.catalogCode=GetQueryString("catalogcode")||"",option.goodsName=decodeURI(decodeURI(GetQueryString("goodsname")))||"",option.isprogram=GetQueryString("isprogram")||"",option.goodsSource=GetQueryString("goodssource")||"",option.status=GetQueryString("status")||"";var o=decodeURI(decodeURI(GetQueryString("cataname")))||"",i=decodeURI(decodeURI(GetQueryString("sourcename")))||"";GetQueryString("programcode");option.unitprice=GetQueryString("unitprice"),option.goodsSource&&(breadcrumb+="<span>&nbsp;&gt;&nbsp;</span>",breadcrumb+='<span><a href="product.html?goodssource='+option.goodsSource+"&status=byGoodsName&sourcename="+i+'">'+i+"</a></span>"),breadcrumb+="<span>&nbsp;&gt;&nbsp;</span>",breadcrumb+="<span>"+option.goodsName+o+"</span>",$(".breadcrumb").html(breadcrumb),initall(option),init(option),$("#productmenu").on("click",".price-item.goods-price",function(o){o.stopPropagation();var i=$(o.target).is("li.price-item"),t=$(o.target).is("i.iconfont"),n=$(this).data("goodsprice");i&&($(".select span.unlimited").removeClass("active"),option.page=1,option.goodsPrice=n,option.downPrice="",option.upPrice="",init(option),$(this).children(".iconfont").show().parents(".price-item").siblings().hide(),$(this).css({background:"#0592F1"}).css({color:"#fff"}).css({"padding-left":"10px"}),$(".text").css({display:"none"})),t&&($(".select span.unlimited").addClass("active"),option.page=1,option.goodsPrice="",init(option),$(this).children(".iconfont").hide().parents("li.price-item").css({background:"transparent"}).css({color:"#0592F1"}).siblings().show(),$(".text").css({display:"inline-block"}),$(".brand-list").scrollTop(0))}),$("#productmenu").on("click",".unprice",function(){option.goodsPrice="",$(".select span.unlimited").removeClass("active"),option.page=1,option.downPrice=$(".downPrice").val(),option.upPrice=$(".upPrice").val(),init(option)}),$("#productmenu").on("click",".brand-list .brand-item",function(o){o.stopPropagation();var i=$(o.target).is("li.brand-item"),t=$(o.target).is("i.iconfont"),n=$(this).data("goodsbrand");i&&($(".select-left span.all").removeClass("active"),option.page=1,option.goodsBrandId=n,init(option),$(this).children(".iconfont").show().parents(".brand-item").siblings().hide(),$(this).css({background:"#0592F1"}).css({color:"#fff"}).css({"padding-left":"10px"}),$(".more").css({display:"none"}),$(".brand-list").css({height:"30px","overflow-y":"hidden"})),t&&($(".select-left span.all").addClass("active"),option.page=1,option.goodsBrandId="",init(option),$(this).children(".iconfont").hide().parents("li.brand-item").css({background:"transparent"}).css({color:"#0592F1"}).siblings().show(),$(".more").css({display:"inline-block"}),$(".all, .brand-list").css({"line-height":"3"}),$(".btn-more").css({"margin-top":"0px"})),$(".btn-more .iconfont").hasClass("icon-shouqi")&&$(".btn-more .iconfont").removeClass("icon-shouqi").addClass("icon-more")}),$(".product-top-left button").click(function(){$(this).addClass("active").siblings().removeClass("active");var o=$(this).data("orderby");option.page=1,option.orderBy=o,init(option)}),$("#productmenu").on("click",".btn-more",function(o){$(".btn-more .iconfont").toggleClass("icon-more icon-shouqi"),$(".btn-more .iconfont").is(".icon-more")?($(".brand-list").css({height:"30px","overflow-y":"hidden"}),$(".btn-more").css({"margin-top":"0px"})):($(".brand-list").css({height:"100px","overflow-y":"auto"}),$(".btn-more").css({"margin-top":"10px"}))}),$("#productmenu").on("click",".input-msg .icon-sousuo",function(o){if(!$.trim($(".input-msg input").val()))return layer.msg("请填写品牌信息",{time:2e3}),!1;$(".input-msg input").hide(),$(".input-msg .icon-sousuo").hide(),$(".input-msg .oth-ct").text($(".input-msg input").val()).css({"padding-left":"10px"}),option.param=$(".input-msg input").val(),option.page=1,init(option),$(".input-msg .input-val").show(),$(".input-msg .input-val .icon-close").css({display:"inline-block"})}),$(".input-msg .input-val .icon-close").click(function(){$(".input-msg input").show(),$(".input-msg .icon-sousuo").show(),$(".input-msg .input-val").hide(),$(".input-msg input").val(""),option.param="",option.page=1,init(option)});var t={renderNew:function(){$.each(goodsArr,function(o,i){var t='<div class="fl pic"><img src='+i.imagePath+' alt="../img/goods.png" width="72" height="60"></div><div class="fl goods-des"><p class=goods-price>&yen;'+i.goodsPrice+'</p><p class="goods-summary">'+i.goodsName+'</p></div><span class="goods-src-'+i.goodsSource+'"></span><a href="javascript:;" idx='+o+' class="del">删除</a>';$(".contrast-product").eq(o).html(t)})},renderOld:function(){$(".goods-list").html(oldHtml)},del:function(o){goodsArr.splice(o,1),0!==goodsArr.length?(this.renderOld(),this.renderNew()):$(".contrast-container").slideUp("slow")}};$("#productlist").on("click",".comparison-click",function(){$(this).children(".contrast").click()}),$("#productlist").on("click",".product-item .contrast",function(o){o.stopPropagation();var i=$(this).attr("cid"),n=$(this).prop("checked"),n=$(this).prop("checked");if(n){if(goodsArr.length>=4)return $(this).prop("checked",!1),void layer.msg("不可以超过4个商品",{time:2e3});$.each(dataArr,function(o,n){this.id==i&&(goodsArr.push(dataArr[o]),t.renderNew())}),$(".contrast-container").slideDown("slow")}if(!n){var e;$.each(goodsArr,function(o,t){i==this.id&&(e=o)}),t.del(e)}}),$(".contrast-container").on("click",".del",function(){var o=$(this).attr("idx"),i=goodsArr[o].id;$(".contrast").each(function(o,t){i==$(this).attr("cid")&&$(this).prop("checked",!1)}),t.del(o)}),$(".btn-close").click(function(){$(".contrast").prop("checked",!1),t.renderOld(),goodsArr=[],$(".contrast-container").slideUp("slow")}),$(".btn-clear").click(function(){$(".btn-close").trigger("click")}),$(".btn-contrast").click(function(){if(1==goodsArr.length)return void layer.msg("最少两个商品",{time:2e3});var o=[];if($.each(goodsArr,function(i){o.push(goodsArr[i].id)}),option.unitprice)var i=window.location.search+"&isComeFrom=true&ids="+o.join("-");else var i=window.location.search+"&ids="+o.join("-");location.href="./comparison.html"+i})});