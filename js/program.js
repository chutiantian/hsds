function changeNo(a){if(!/^[1-9]*[1-9][0-9]*$/.test(a))return layer.msg("页码只能是数字！"),!1;$(".pageIndex").val(a);var t=getParamOpt();init(t,a)}$(function(){function a(a,t,e){if("1"!=a.code)return void console.log("数据加载失败");var r=Handlebars.compile($(t).html()),n=r(a.data);$(e).html(n)}function t(){var a={};a.programCode=$.trim($("#programCode").val()),a.programName=$.trim($("#programName").val()),a.govCname=$.trim($("#bdgagencyName").val()),a.acctyear=$.trim($("#acctyear").val());var t=$.trim($("#purchaseState span").text());return"全部"==t&&(a.purchaseState=""),"采购中"==t&&(a.purchaseState=0),"已完成"==t&&(a.purchaseState=1),a}function e(t,e){var o=$.extend({page:e||1,limit:1,programCode:"",programName:"",govCname:"",acctyear:n,purchaseState:""},t);getdata("../js/json/plan.json",o,"get",function(t){r=t.data,a(t,"#plan-tpl",".purchasing-con"),orgpageInit("changeNo",".paginorange",t.data.totalPage,e)}),$(window).scrollTop(0)}var r="",n=(new Date).getFullYear();e(),$(".confirm").on("click",function(){e(t())}),$(".reset").on("click",function(){$("#programCode").val(""),$("#programName").val(""),$("#bdgagencyName").val(""),$("#acctyear").val(n),$("#purchaseState span").text("全部")}),$('[data-toggle="datepicker"]').datepicker({language:"zh-CN",startDate:"2015",endDate:n,format:"yyyy",yearSuffix:"年",autoHide:!0,autoPick:!0}),$("#purchaseState").on("click",function(){$(".drop-menu").show()}),$(".menu").on("mouseleave",function(){$(".drop-menu").hide()}),$(".drop-menu li").on("click",function(){var a=$(this).text();$("#purchaseState span").html(a),$(".drop-menu").hide()}),$(".purchasing-con").on("click",".view",function(){var a=$(this).attr("program-item-id"),t=$(this).attr("purchase-heading-id"),e={programItemId:a,purchaseHeadingId:t};location.href="./order-detail.html?"+qs(e)}),$(".purchasing-con").on("click",".single-price",function(){var a=$($(this).parentsUntil("li")[3]).attr("index"),t=$(this).attr("index"),e=r.list[a].purchaseheadingList[t],n={programcode:e.id,programitemid:e.programItemId,catalogcode:e.systemCatalogCode,cataname:e.purchaseListName,unitprice:e.unitprice,cartnum:e.num,status:"byPurchaseCatalog"};location.href="./product.html?"+qs(n)}),window.init=e,window.getParamOpt=t});